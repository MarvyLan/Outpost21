<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_nevreanstand</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-5</depth>
  <persistent>0</persistent>
  <parentName>obj_hostobject</parentName>
  <maskName>spr_player_mask</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>player_stats = ds_map_create();

player_stats[? "set_hp"] = 4;
player_stats[? "mod_hp"] = 0;

player_stats[? "set_maxhp"] = 4;
player_stats[? "mod_maxhp"] = 0;

player_stats[? "set_speed"] = 4;
player_stats[? "mod_speed"] = 0;


//mouse input
mouse_get_x = x;
mouse_get_y = y;
mouse_puppet = instance_create(x,y,obj_puppet_nosync);

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>with mouse_puppet instance_destroy();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///calculate movements
if (scr_client_controllock() == false and global.client_loading == false) or room == rm_menu { //if loaded in, or in the intro!
    //mouse inputs!
    //get distance
    var pointer_distance = point_distance(x,y,mouse_get_x,mouse_get_y);
    var pointer_direction = point_direction(x,y,mouse_get_x,mouse_get_y);
    
    //walking control
    var get_player_speed = player_stats[? "set_speed"] + player_stats[? "mod_speed"];
    if ceil(pointer_distance) &lt; 150 or global.client_grab_entity != -1 { //slow movement if pulling
        if ceil(pointer_distance) &lt; 75 { 
            get_player_speed /= 3;
        }
        else
        {
            get_player_speed /= 2;
        }
        //get_player_speed *= lerp(0.20,0.60,pointer_distance/200); //walk based on distance.
    }
    
    //stop control
    if pointer_distance &lt; 16 get_player_speed = 0;
    
    //collison check
    var xdisp = lengthdir_x(get_player_speed,pointer_direction);
    var ydisp = lengthdir_y(get_player_speed,pointer_direction);
    
    //forward this to the step event
    movex = xdisp;
    movey = ydisp;
    
    
    //facing control
    if global.client_grab_entity == -1 
    or is_undefined(obj_client.list_entity_cache[| global.client_grab_entity]) 
    or instance_exists(obj_client.list_entity_cache[| global.client_grab_entity]) == false {
        if sign(movex + forcedx) != 0 {
            image_xscale = sign(movex + forcedx);
        }
    }
    else
    {
        //face what we haul
        var get_inst = obj_client.list_entity_cache[| global.client_grab_entity];
        image_xscale = sign(get_inst.x - x);
        if image_xscale = 0 image_xscale = 1;
    }
    
    //animation control
    var goal_anim = skeleton_animation_get();
    
    if (movex + forcedx) != 0 and (movey + forcedy) != 0 {
        if floor(point_distance(x,y,x+(movex + forcedx),y+(movey + forcedy))) &lt; 3 {
            goal_anim = "Walk";
        }
        else
        {
            goal_anim = "Run";
        }
    }
    else
    {
        var goal_anim = "Stand";
    }
    //set anim
    if skeleton_animation_get() != goal_anim {
        skeleton_animation_set(goal_anim);
    }
    
        
    
    //collision control!
    var box_radius = 18;
    var prex = x;
    var prey = y;
    
    var move_dis = point_distance(0,0,movex + forcedx,movey + forcedy);
    if move_dis != 0 {
        if collision_rectangle(x + movex + forcedx-box_radius,y-box_radius,x + movex + forcedx + box_radius,y + box_radius,obj_wall,true,true) == noone {
            x += movex + forcedx;
        }
        
        if collision_rectangle(x-box_radius,y + movey + forcedy-box_radius,x+box_radius,y + movey + forcedy+box_radius,obj_wall,true,true) == noone {
            y += movey + forcedy;
        }
        //correct location if stuffed in wall....
        if collision_rectangle(x-box_radius,y-box_radius,x+box_radius,y+box_radius,obj_wall,true,true) != noone {
            x = xprevious;
            y = yprevious;
        }    
    }
    
    //reset movement and slow down due to air resistance
    movex *= 0.10;
    movey *= 0.10;
    forcedx *= 0.98;
    forcedy *= 0.98;
    
    
    //set draw depth
    scr_set_depth(y,0);
    
    //set indoors or not
    global.player_indoors = (collision_rectangle(x-5,y-5,x+5,y+5,obj_construction_floor_parent,true,true) != noone);
    
    //update mouse puppet
    if instance_exists(mouse_puppet) == false mouse_puppet =instance_create(x,y,obj_puppet);
    with mouse_puppet {
        if pointer_distance &lt; 16 {
            visible = false;
        }
        else 
        {
            visible = true;
            sprite_index = spr_goto
            image_alpha = 0.40;
        
            x = other.mouse_get_x;
            y = other.mouse_get_y;
            scr_set_depth(y,0);
        }
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="51">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///get the mouse location!
if global.construction_mode == false {
    mouse_get_x = mouse_x;
    mouse_get_y = mouse_y;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//draw circle
draw_sprite_ext(spr_player_mask,0,x,y,image_xscale,1,0,image_blend,1);
//draw spine sprite
draw_self();

//draw_set_color(c_white);
//draw_text(x,y-32,100*(global.player_light/global.entity_activation_range));
//draw_set_color(c_black);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="73">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///create inventory
if room == rm_map and scr_client_controllock() == false {
    if instance_exists( obj_inventory_player) {
        with obj_inventory_player instance_destroy();
    }
    else
    {
        instance_create(0,0, obj_inventory_player);
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="10" enumb="97">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>global.weather_severity += 1;
if global.weather_severity &gt; 10 global.weather_severity = 10;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="10" enumb="96">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>global.weather_severity -= 1;
if global.weather_severity &lt; 0 global.weather_severity = 0;
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
